<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Custom Form → Google Sheet</title>
<style>
  :root { --maxw:760px; --accent:#0b76ef; font-family:Inter,system-ui,Segoe UI,Roboto,Arial; }
  body{display:flex;align-items:center;justify-content:center;min-height:100vh;margin:0;background:#f6f8fb;padding:28px;}
  .card{width:100%;max-width:var(--maxw);background:#fff;border-radius:12px;box-shadow:0 6px 30px rgba(20,30,40,0.06);padding:28px;}
  h1{margin:0 0 8px;font-size:20px}
  p.lead{margin:0 0 18px;color:#555}
  label{display:block;margin:12px 0 6px;font-weight:600;color:#222}
  input[type=text],input[type=email],textarea{width:100%;padding:12px;border-radius:8px;border:1px solid #e3e7ee;box-sizing:border-box}
  textarea{min-height:120px;resize:vertical}
  .row{display:flex;gap:12px}
  .row > *{flex:1}
  button{background:var(--accent);color:#fff;padding:12px 16px;border-radius:10px;border:0;font-weight:700;cursor:pointer;margin-top:16px}
  .hint{font-size:13px;color:#666;margin-top:10px}
  .hidden{display:none}
  .success{background:#e6ffed;border:1px solid #8ce0a6;padding:10px;border-radius:8px;color:#0b6c30;margin-top:12px}
  .error{background:#fff0f0;border:1px solid #f0a6a6;padding:10px;border-radius:8px;color:#8b1b1b;margin-top:12px}
</style>
</head>
<body>
  <main class="card" role="main">
    <h1>Custom Form</h1>
    <p class="lead">No login, custom design. Submits to Google Sheets.</p>

    <form id="myForm">
      <label for="name">Full name</label>
      <input id="name" name="name" type="text" required />

      <div class="row">
        <div>
          <label for="email">Email</label>
          <input id="email" name="email" type="email" />
        </div>
        <div>
          <label for="phone">Phone</label>
          <input id="phone" name="phone" type="text" />
        </div>
      </div>

      <label for="notes">Notes</label>
      <textarea id="notes" name="notes"></textarea>

      <!-- honeypot anti-spam (hidden to humans) -->
      <div class="hidden"><label>Do not fill</label><input name="hp" autocomplete="off"></div>

      <button type="submit">Send</button>

      <div id="msg" class="hint" aria-live="polite"></div>
    </form>
  </main>

<script>
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxDZEV2wXfpwvQzUt2k3rYQHOBFuOo-TpZcQikRkBtcImjrxuHLio5nXH02tsb9WLkfZQ/exec'; // ← paste Apps Script web app URL

const form = document.getElementById('myForm');
const msg = document.getElementById('msg');

form.addEventListener('submit', async (ev) => {
  ev.preventDefault();
  msg.textContent = 'Sending...';

  // simple honeypot
  if (form.hp && form.hp.value) {
    msg.textContent = 'Spam detected';
    return;
  }

  const data = {
    name: form.name.value.trim(),
    email: form.email.value.trim(),
    phone: form.phone.value.trim(),
    notes: form.notes.value.trim()
  };

  try {
    // Send JSON POST to Apps Script
    const res = await fetch(WEB_APP_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    // Some Apps Script deployments may require no-cors; if you get CORS issues,
    // switch to form submission (see README notes below).
    if (!res.ok) {
      // still try to read text (Apps Script sometimes returns 200 but content type)
      const txt = await res.text();
      throw new Error('Server rejected: ' + txt);
    }

    const json = await res.json();
    if (json && json.status === 'ok') {
      msg.textContent = 'Thanks — submission recorded.';
      form.reset();
    } else {
      throw new Error((json && json.message) || 'Unknown response');
    }
  } catch (err) {
    // fallback: try a simple form POST (some Apps Script web apps accept this)
    try {
      const formData = new FormData(form);
      await fetch(WEB_APP_URL, { method: 'POST', body: formData });
      msg.textContent = 'Submission sent (fallback).';
      form.reset();
    } catch (err2) {
      console.error(err, err2);
      msg.textContent = 'Error sending form: ' + (err.message || err2.message);
    }
  }
});
</script>
</body>
</html>
